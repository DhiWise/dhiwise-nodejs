
const response = require('../../utils/response');
const makeLoginUser = require('../common/loginUser'); 

/**
* @description : login with username and password
* @param {Object} params : request body.
* @param {Number} platform : platform identification.
* @return {Object} : response of authentication {status, message, data}
*/
const authentication = ({ <%-USER_MODEL-%>Db,userTokensDb}) => async (params, platform) => {
    let username = params.username;
    let password = params.password;
    if(!username || !password){
        return response.badRequest()
    }
    const loginUser = makeLoginUser({<%-USER_MODEL-%>Db,userTokensDb});
    return await loginUser(username, platform, password);
}
module.exports = authentication;